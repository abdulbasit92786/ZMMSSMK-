<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>üì¶ NFT Plans</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}
    body{background:linear-gradient(to right,#141e30,#243b55);color:#fff;padding:30px 20px}
    h1{text-align:center;font-size:2.5em;color:#00ffc3;margin-bottom:10px}
    p{text-align:center;font-size:1.2em;margin-bottom:30px}
    .balances{display:flex;justify-content:center;gap:40px;font-size:1.1em;margin-bottom:20px}
    .balances span{font-weight:bold;color:#00ffc3}
    .plan-container{display:flex;flex-wrap:wrap;justify-content:space-between;gap:20px}
    .plan-section{flex:1;min-width:300px;background-color:rgba(255,255,255,0.05);padding:20px;border-radius:12px;box-shadow:0 4px 15px rgba(0,0,0,0.5)}
    .plan-section h2{text-align:center;margin-bottom:20px;color:#00ffc3}
    .plan{background-color:rgba(255,255,255,0.1);border-radius:10px;padding:15px;margin-bottom:15px;color:#fff;transition:transform 0.3s ease}
    .plan:hover{transform:translateY(-5px)}
    .plan h3{margin-bottom:8px;font-size:1.2em;color:#00ffc3}
    .plan p{margin:4px 0;font-size:0.95em}
    .plan button{margin-top:10px;padding:8px 12px;font-size:1em;border:none;border-radius:6px;background-color:#00ffc3;color:#000;cursor:pointer;transition:background 0.3s ease}
    .plan button:hover{background-color:#00c9a7}
    @media(max-width:768px){.plan-container{flex-direction:column}}
  </style>
</head>
<body>
  <h1>ü™ô NFT Access Plans</h1>
  <p>Buy a plan using USDT or ZMM to activate missions and rewards.</p>
  <div class="balances">
    <div>üíµ USDT Balance: <span id="usdt-dashboard">Loading...</span></div>
    <div>ü™ô ZMM Balance: <span id="zmm-dashboard">Loading...</span></div>
  </div>

  <div class="plan-container">
    <div class="plan-section" id="usdt-section"></div>
    <div class="plan-section" id="zmm-section"></div>
  </div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBN4LbA8udE4POVTR-XlZgpHQOvuNcSMI4",
  authDomain: "zmmssmk.firebaseapp.com",
  databaseURL: "https://zmmssmk-default-rtdb.firebaseio.com",
  projectId: "zmmssmk",
  storageBucket: "zmmssmk.appspot.com",
  messagingSenderId: "677420760492",
  appId: "1:677420760492:web:2c27c0f0ed6490b8dfce09"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.database();

let wallet = { usdt: 0, zmm: 0 };
let currentUserId = null;

const PLAN_CONFIG = {
  usdt: [
    { amount: 10, duration: 30, videoReward: 2, dailyReward: 2 },
    { amount: 25, duration: 30, videoReward: 6, dailyReward: 4 },
    { amount: 50, duration: 30, videoReward: 10, dailyReward: 6 },
    { amount: 100, duration: 30, videoReward: 16, dailyReward: 12 },
    { amount: 500, duration: null, videoReward: 22, dailyReward: 20 }
  ],
  zmm: [
    { amount: 1000, duration: 30, videoReward: 2, dailyReward: 2 },
    { amount: 2500, duration: 30, videoReward: 6, dailyReward: 4 },
    { amount: 5000, duration: 30, videoReward: 10, dailyReward: 6 },
    { amount: 10000, duration: 30, videoReward: 16, dailyReward: 12 },
    { amount: 50000, duration: null, videoReward: 22, dailyReward: 20 }
  ]
};

function updateBalanceUI() {
  document.getElementById("usdt-dashboard").textContent = "$" + wallet.usdt.toFixed(2);
  document.getElementById("zmm-dashboard").textContent = wallet.zmm.toFixed(2) + " ZMM";
}

function renderPlans() {
  ["usdt", "zmm"].forEach(type => {
    const container = document.getElementById(`${type}-section`);
    container.innerHTML = `<h2>${type === "usdt" ? "üíµ USDT Plans" : "ü™ô ZMM Token Plans"}</h2>`;
    PLAN_CONFIG[type].forEach(plan => {
      const div = document.createElement("div");
      div.className = "plan";
      div.innerHTML = `
        <h3>${type === "usdt" ? "$" + plan.amount : plan.amount + " ZMM"}</h3>
        <p>${plan.duration ? "1 Month Access" : "Lifetime Access"}</p>
        <p>üé• Video Reward: ${plan.videoReward}</p>
        <p>‚è∞ Every 4 Hours: ${plan.dailyReward}</p>
      `;
      const btn = document.createElement("button");
      btn.textContent = wallet[type] >= plan.amount ? "Buy" : "Insufficient Balance";
      btn.disabled = wallet[type] < plan.amount;
      btn.onclick = () => buyPlan(type, plan.amount);
      div.appendChild(btn);
      container.appendChild(div);
    });
  });
}

async function fetchUserData(uid) {
  currentUserId = uid;
  db.ref(`users/${uid}/wallet`).on("value", snapshot => {
    const data = snapshot.val();
    wallet = {
      usdt: data?.usdt || 0,
      zmm: data?.zmm || 0
    };
    updateBalanceUI();
    renderPlans();
  });
}

async function buyPlan(type, amount) {
  wallet[type] -= amount;
  try {
    await db.ref(`users/${currentUserId}/wallet`).set(wallet);
    updateBalanceUI();
    renderPlans();
    alert("‚úÖ Plan purchased successfully!");
  } catch (error) {
    alert("‚ùå Failed to purchase plan. Try again.");
    console.error(error);
  }
}

auth.onAuthStateChanged(user => {
  if (user) {
    fetchUserData(user.uid);
  } else {
    alert("‚ö†Ô∏è Please log in first.");
    window.location.href = "login.html";
  }
});
</script>
</body>
  </html>
